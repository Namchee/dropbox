var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,s=Object.getOwnPropertySymbols,i=Object.prototype.propertyIsEnumerable,o=(t,s,i)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[s]=i,r=(e,r)=>{for(var a in r||(r={}))t.call(r,a)&&o(e,a,r[a]);if(s)for(var a of s(r))i.call(r,a)&&o(e,a,r[a]);return e};import{P as a,w as n,p as h}from"./vendor.ff13e120.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(s){const i=new URL(e,location),o=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((s,r)=>{const a=new URL(e,i);if(self[t].moduleMap[a])return s(self[t].moduleMap[a]);const n=new Blob([`import * as m from '${a}';`,`${t}.moduleMap['${a}']=m;`],{type:"text/javascript"}),h=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(n),onerror(){r(new Error(`Failed to import: ${e}`)),o(h)},onload(){s(self[t].moduleMap[a]),o(h)}});document.head.appendChild(h)})),self[t].moduleMap={}}}("/dropbox/assets/");class d extends a.Loader.File{constructor(e,t,s="google"){super(e,{type:"webfont",key:t.toString()}),this.fontNames=Array.isArray(t)?t:[t],this.service=s}load(){const e={active:()=>{this.loader.nextFile(this,!0)}};switch(this.service){case"google":e.google={families:this.fontNames};break;default:throw new Error("Unsupported font service")}n.load(e)}}const l={fontFamily:'"Press Start 2P"'};class p extends a.Scene{constructor(){super("HomeScene")}preload(){var e;(e=this).load.image("background","/dropbox/bg-pattern.png"),e.load.spritesheet("terrain","/dropbox/terrain.png",{frameWidth:16,frameHeight:16}),e.load.spritesheet("player","/dropbox/player.png",{frameWidth:32,frameHeight:32}),e.load.spritesheet("player-run","/dropbox/player-run.png",{frameWidth:32,frameHeight:32}),e.load.spritesheet("player-die","/dropbox/fx/die.png",{frameWidth:96,frameHeight:96}),e.load.image("box-1","/dropbox/box-1.png"),e.load.spritesheet("box-1-break","/dropbox/fx/box-1-break.png",{frameWidth:24,frameHeight:24}),e.load.image("box-2","/dropbox/box-2.png"),e.load.spritesheet("box-2-break","/dropbox/fx/box-2-break.png",{frameWidth:24,frameHeight:24}),e.load.image("box-3","/dropbox/box-3.png"),e.load.spritesheet("box-3-break","/dropbox/fx/box-3-break.png",{frameWidth:24,frameHeight:24}),e.load.image("smoke","/dropbox/fx/smoke.png"),e.load.image("home","/dropbox/buttons/home.png"),e.load.image("home-pressed","/dropbox/buttons/home-pressed.png"),e.load.image("restart","/dropbox/buttons/restart.png"),e.load.image("restart-pressed","/dropbox/buttons/restart-pressed.png"),e.load.image("play","/dropbox/buttons/play.png"),e.load.image("play-pressed","/dropbox/buttons/play-pressed.png"),e.load.image("volume-on","/dropbox/buttons/volume-on.png"),e.load.image("volume-off","/dropbox/buttons/volume-off.png"),e.load.audio("tick","/dropbox/sfx/tick.wav"),e.load.audio("break","/dropbox/sfx/break.wav"),e.load.audio("die","/dropbox/sfx/die.wav"),e.load.audio("button","/dropbox/sfx/button.wav"),e.load.addFile(new d(e.load,"Press Start 2P"))}create(){this.scene.bringToTop(),this.sfx=!0;const{width:e,height:t}=this.game.config;this.bgTexture=this.add.renderTexture(0,0,Number(e),Number(t)),this.bgTexture.fill(0,.6),this.titleText=this.add.text(Number(e)/2,.4*Number(t),"DROP.BOX",r(r({},l),{fontSize:"32px"})),this.titleText.setOrigin(.5,.5),this.titleText.setAlpha(0),this.playButton=this.add.image(Number(e)/2,.525*Number(t),"play"),this.playButton.setFrame(0),this.playButton.setOrigin(.5,.5),this.playButton.setScale(2.25),this.playButton.setAlpha(0),this.sfxButton=this.add.image(Number(e)-24,Number(t)-24,"volume-on"),this.sfxButton.setFrame(1),this.sfxButton.setScale(1.25),this.sfxButton.setAlpha(0),this.tweens.add({targets:[this.playButton,this.sfxButton,this.titleText],alpha:1,ease:"Sine.easeOut",duration:500,onComplete:()=>{this.initMenu()}}),this.scene.launch("GameScene")}initMenu(){this.playButton.setInteractive({cursor:"pointer"}),this.sfxButton.setInteractive({cursor:"pointer"}),this.sfxButton.on("pointerup",(()=>{this.toggleSfx()})),this.playButton.on("pointerdown",(()=>{this.playButton.setTexture("play-pressed")})),this.playButton.on("pointerup",(()=>{this.sound.play("button"),this.playButton.setTexture("play"),this.tweens.add({targets:[this.bgTexture,this.playButton,this.sfxButton,this.titleText],alpha:0,duration:350,onComplete:()=>{this.scene.sendToBack(),this.scene.get("GameScene").startGame()}})}))}toggleSfx(){this.sound.play("button"),this.sfx=!this.sfx,this.sfx?(this.sfxButton.setTexture("volume-on"),this.sound.volume=1):(this.sfxButton.setTexture("volume-off"),this.sound.volume=0)}}class c extends a.Physics.Arcade.Sprite{constructor(e,t,s){super(e,t,s,"player"),e.physics.world.enable(this),e.add.existing(this)}get isDead(){return this._isDead}static create(e){const{width:t,height:s}=e.game.config,i=new c(e,Number(t)/2,Number(s)-8);return i.setCollideWorldBounds(!0),i.initAnimations(),i.idle(),i}initAnimations(){this.anims.create({key:"chara-idle",frames:this.anims.generateFrameNumbers("player",{}),frameRate:24,repeat:-1}),this.anims.create({key:"chara-run",frames:this.anims.generateFrameNumbers("player-run",{}),frameRate:24,repeat:-1}),this.anims.create({key:"chara-dead",frames:this.anims.generateFrameNumbers("player-die",{}),frameRate:24,hideOnComplete:!0,repeat:3})}listenInputs(){const e=this.scene.input.keyboard.addKey(a.Input.Keyboard.KeyCodes.LEFT),t=this.scene.input.keyboard.addKey(a.Input.Keyboard.KeyCodes.RIGHT);e.on("down",(()=>{this.isLeftDown=!0,this.walk(-150,!0)})),e.on("up",(()=>{this.isLeftDown=!1,this.isRightDown?this.walk(150,!1):this.idle()})),t.on("down",(()=>{this.isRightDown=!0,this.walk(150,!1)})),t.on("up",(()=>{this.isRightDown=!1,this.isLeftDown?this.walk(-150,!0):this.idle()}))}disableInputs(){this.isLeftDown=!1,this.isRightDown=!1,this.scene.input.keyboard.removeKey(a.Input.Keyboard.KeyCodes.LEFT),this.scene.input.keyboard.removeKey(a.Input.Keyboard.KeyCodes.RIGHT)}walk(e,t){this.body.enable&&(this.setVelocityX(e),this.setFlipX(t),this.anims.play("chara-run"))}idle(){this.body.enable&&(this.setVelocityX(0),this.anims.play("chara-idle"))}revive(){this.body.enable=!0,this.setVisible(!0),this._isDead=!1;const{width:e,height:t}=this.scene.game.config;this.setPosition(Number(e)/2,Number(t)-8),this.setFlipX(!1),this.idle()}die(){this.body.enable=!1,this._isDead=!0,this.anims.stop(),this.anims.play("chara-dead")}setDieCallback(e){this.on("animationcomplete",e)}}const u=class extends a.Physics.Arcade.Image{constructor(e,t,s,i){super(e,t,s,`box-${i}`),e.physics.world.enable(this),e.add.existing(this),this.debrisManager=e.add.particles(`box-${i}-break`);this.debrisManager.createEmitter({frame:[0,1,2,3],quantity:8,gravityY:250,lifespan:2250,maxParticles:12,alpha:{start:1,end:0},scale:{start:.75*u.SCALING[i],end:.75*u.SCALING[i]},on:!1}).setBounds(t,Number(this.scene.game.config.height)-this.displayHeight,16,this.displayHeight-8),this.smokeManager=e.add.particles("smoke"),this.smokeManager.createEmitter({on:!1,maxParticles:1,scale:{start:4*u.SCALING[i],end:4*u.SCALING[i]},alpha:{start:1,end:0},quantity:1,lifespan:2e3})}static createRandomBox(e,t=250){const s=Math.floor(3*Math.random())+1,{width:i}=e.game.config,o=new u(e,Math.random()*Number(i),-16*u.SCALING[s],s);return o.setOrigin(.5,.5),o.setCollideWorldBounds(!0),o.body.onWorldBounds=!0,o.handleWorldCollision(),o.setScale(u.SCALING[s],u.SCALING[s]),o.setGravityY(t*u.SCALING[s]),o}handleWorldCollision(){const{height:e}=this.scene.game.config;this.body.world.on("worldbounds",(()=>{if(!this.active)return;const{x:t,y:s}=this.body.position;Number(e)-(s+this.displayHeight)==8&&(this.debrisManager.emitParticleAt(t+this.displayWidth/2,s+.8*this.displayHeight),this.smokeManager.emitParticleAt(t+this.displayWidth/2,s+this.displayHeight/3),this.setVisible(!1),this.setActive(!1))}))}};let m=u;m.SCALING={1:1,2:1.33,3:1.67};class b{constructor(){this._isRunning=!1,this._score=0}get isRunning(){return this._isRunning}get score(){return this._score}set score(e){this._score=e}startGame(){this._isRunning=!0}stopGame(){this._isRunning=!1}incrementScore(){this.score=this.score+1}}class g{static getInstance(){return g.instance||(g.instance=new g),g.instance}get highScore(){return Number(localStorage.getItem("high-score"))||0}setHighScore(e){localStorage.setItem("high-score",e.toString())}}const x=class extends a.Scene{constructor(){super("GameScene")}create(){const{width:e,height:t}=this.game.config;this.state=this.initState(),this.add.tileSprite(0,0,Number(e),Number(t),"background").setOrigin(0,0),this.add.tileSprite(0,Number(t),Number(e),16,"terrain",2).setOrigin(0,.5),this.physics.world.setBounds(0,0,Number(e),Number(t)-8),this.boxes=this.add.group(),this.player=c.create(this),this.player.setDepth(1),this.player.setDieCallback((()=>{this.sound.play("die"),this.showResultScene()}));const s=g.getInstance().highScore;this.scoreText=this.add.text(16,16,`SCORE: ${this.state.score.toString().padStart(5,"0")}`,r(r({},l),{fontSize:"12px"})),this.highScoreText=this.add.text(Number(e)-16,16,`HI: ${s.toString().padStart(5,"0")}`,r(r({},l),{fontSize:"12px"})),this.highScoreText.setOrigin(1,0),this.spawnTime=0}startGame(){const{width:e,height:t}=this.game.config;let s=3;const i=this.add.text(Number(e)/2,.45*Number(t),s.toString(),r(r({},l),{fontSize:"48px"})),o=this.add.text(Number(e)/2,.6*Number(t),"Use arrow keys to move your characters and avoid falling boxes!",r(r({},l),{fontSize:"12px",wordWrap:{width:225},align:"center"}));i.setOrigin(.5,.5),o.setOrigin(.5,.5),this.sound.play("tick");const a=this.time.addEvent({delay:1e3,loop:!0,callbackScope:this,callback:()=>{if(s--,isNaN(Number(i.text)))return i.destroy(),this.state.startGame(),this.setCollision(),this.player.listenInputs(),this.boxes.add(m.createRandomBox(this)),void a.destroy();s>0?i.setText(s.toString()):(i.setText("GO!"),o.destroy()),this.sound.play("tick")}})}setCollision(){this.physics.add.collider(this.player,this.boxes,(()=>{this.player.die(),this.player.disableInputs()}))}initState(){const e=new b;return new Proxy(e,{set:(e,t,s)=>(e[t]=s,"score"===t&&this.setScore(s),!0)})}update(e,t){if(!this.state.isRunning)return;this.boxes.children.each((e=>{e.active||(this.sound.play("break"),this.boxes.killAndHide(e),this.boxes.remove(e),this.player.isDead||this.state.incrementScore())}));let s="0";const i=Object.keys(x.spawnTime);for(let o=0;o<i.length&&this.state.score>=x.spawnTime[i[o]];o++)s=i[o];this.spawnTime+=t,this.spawnTime>=x.spawnTime[s]&&(this.spawnTime=0,this.boxes.add(m.createRandomBox(this)))}setScore(e){this.scoreText.setText(`SCORE: ${e.toString().padStart(5,"0")}`)}showResultScene(){const e=g.getInstance(),t=e.highScore<this.state.score;t&&(this.highScoreText.setText(`HI: ${this.state.score.toString().padStart(5,"0")}`),e.setHighScore(this.state.score)),this.scene.launch("ResultScene",{state:this.state,isRecord:t})}restart(){this.cleanup(),this.startGame()}cleanup(){this.state=this.initState(),this.player.revive(),this.input.setDefaultCursor("default"),this.boxes.children.each((e=>{this.boxes.remove(e),e.setActive(!1),e.destroy()}))}};let y=x;y.spawnTime={0:750,25:500,50:250,100:100};class f extends a.Scene{constructor(){super("ResultScene")}init(e){this.state=e.state,this.isRecord=e.isRecord}create(){this.scene.bringToTop();const{width:e,height:t}=this.game.config,{score:s}=this.state;let i;this.bgTexture=this.add.renderTexture(0,0,Number(e),Number(t)),this.bgTexture.fill(0,.7),this.bgTexture.setAlpha(0),this.titleText=this.add.text(Number(e)/2,-100,"Game Over!",r(r({},l),{fontSize:"24px"})),this.scoreText=this.add.text(-100,3.75*Number(t)/10,`Your Score: ${s}`,r(r({},l),{fontSize:"14px"})),this.replayButton=this.add.image(Number(e)/2+32,Number(t)+100,"restart"),this.homeButton=this.add.image(Number(e)/2-32,Number(t)+100,"home"),this.replayButton.setScale(1.75),this.replayButton.setInteractive({cursor:"pointer"}),this.homeButton.setScale(1.75),this.homeButton.setInteractive({cursor:"pointer"}),this.titleText.setOrigin(.5),this.scoreText.setOrigin(.5),this.isRecord&&(i=this.add.text(Number(e)+100,.425*Number(t),"New Record!",r(r({},l),{fontSize:"10px"})),i.setOrigin(.5)),this.tweens.add({targets:this.bgTexture,alpha:1,duration:1e3,onComplete:()=>{this.tweens.add({targets:this.titleText,y:Number(t)/10*3,ease:"Power2",duration:1e3,onComplete:()=>{this.tweens.add({targets:this.scoreText,x:Number(e)/2,ease:"Power2",duration:1500}),i&&this.tweens.add({targets:i,x:.525*Number(e),ease:"Power2",duration:1500}),this.tweens.add({targets:this.replayButton,y:.525*Number(t),ease:"Power2",duration:1500,onComplete:()=>{this.restartGame()}}),this.tweens.add({targets:this.homeButton,y:.525*Number(t),ease:"Power2",duration:1500,onComplete:()=>{this.backToHome()}})}})}})}restartGame(){this.replayButton.setInteractive({cursor:"pointer"}),this.replayButton.on("pointerdown",(()=>{this.replayButton.setTexture("restart-pressed")})),this.replayButton.on("pointerup",(()=>{this.sound.play("button"),this.replayButton.setTexture("restart");const e=this.scene.get("GameScene");this.scene.setActive(!1),this.scene.setVisible(!1),this.scene.sendToBack(),this.input.disable(this.homeButton),this.input.disable(this.replayButton),e.restart()}))}backToHome(){this.homeButton.setInteractive({cursor:"pointer"}),this.homeButton.on("pointerdown",(()=>{this.homeButton.setTexture("home-pressed")})),this.homeButton.on("pointerup",(()=>{this.sound.play("button"),this.homeButton.setTexture("home"),this.scene.start("HomeScene")}))}}const w={type:h.AUTO,width:320,height:480,background:"transparent",physics:{default:"arcade",arcade:{gravity:{y:200}}},parent:"game",scene:[p,y,f]};new h.Game(w);
